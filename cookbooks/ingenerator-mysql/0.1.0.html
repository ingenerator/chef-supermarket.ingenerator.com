<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MiniMart</title>

  <!-- fonts -->
  <link href='//fonts.googleapis.com/css?family=Maven+Pro:400,700' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,700,600' rel='stylesheet' type='text/css'>
  <!-- css -->
  <link rel="stylesheet" href="../../assets/stylesheets/application.min.css" />
  <!-- js -->
  <script src="../../assets/javascripts/application.min.js"></script>
</head>
<body>
  <a href="../../index.html">
  <header class="header-slim">
    <div class="header-slim__container">
      <h1 class="header-slim__title">Welcome to MiniMart</h1>
      <h2 class="header-slim__subtitle">Always open and always open sourced.</h2>
    </div>
  </header>
  </a>

  <div class="outer-wrapper">
    <form action="../../index.html#search/" method="GET" id="cookbook-search-form">
  <div class="search">
    <div class="search__td">
      <input name="query" type="search">
    </div>
    <div class="search__td search__td--btn">
      <button type="submit">Search</button>
    </div>
  </div>
</form>

<main class="detail-content">
  <h1 class="detail-content__title">
    ingenerator-mysql
    <span>
      (8) Versions
      <select class="cookbook-version-selector">
        <option disabled selected>
          <small>0.1.0</small>
        </option>
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.6.0.html">0.6.0</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.5.1.html">0.5.1</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.5.0.html">0.5.0</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.4.1.html">0.4.1</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.4.0.html">0.4.0</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.3.0.html">0.3.0</option>
          
        
          
            <option value="../../cookbooks/ingenerator-mysql/0.2.0.html">0.2.0</option>
          
        
          
        
      </select>
    </span>
  </h1>

  <p>Standard mySQL installation for our applications, including relevant PHP and application config</p>
  <code class="install-instructions">cookbook 'ingenerator-mysql', '~> 0.1.0'</code>

  <div class="tab-container">
    <ul class="detail-content__tabs">
      <li><a href="#readme-tab">Readme</a></li>
      <li><a href="#dependencies-tab">Dependencies</a></li>
      <li><a href="#changelog-tab">Changelog</a></li>
    </ul>

    <div id="readme-tab" class="markdown">
      <h1>inGenerator MySQL cookbook</h1>

<p><a href="https://travis-ci.org/ingenerator/chef-ingenerator-mysql"><img src="https://travis-ci.org/ingenerator/chef-ingenerator-mysql.png?branch=master" alt="Build Status"></a></p>

<p>The <code>ingenerator-mysql</code> cookbook supports standard installation of mySQL for our applications
that use it, and also defines attributes and recipes that support applications that depend on
it. For example, if used with our <code>ingenerator-php</code> cookbook, the php mysql extension will be
installed as part of the php install.</p>

<h2>Requirements</h2>

<ul>
<li>Chef 12.13 or higher</li>
<li><strong>Ruby 2.3 or higher</strong></li>
</ul>

<h2>Installation</h2>

<p>We recommend adding to your <code>Berksfile</code> and using <a href="http://berkshelf.com/">Berkshelf</a>:</p>

<pre><code class="ruby">cookbook &#39;ingenerator-mysql&#39;, git: &#39;git://github.com/ingenerator/chef-ingenerator-mysql&#39;, branch: &#39;master&#39;
</code></pre>

<p>Have your main project cookbook <em>depend</em> on ingenerator-mysql by editing the <code>metadata.rb</code> for your cookbook.</p>

<pre><code class="ruby"># metadata.rb
depends &#39;ingenerator-mysql&#39;
</code></pre>

<h2>User passwords</h2>

<blockquote>
<p>By default, the root password is set to &#39;mysql&#39; and the app user password to the project name. This is valid for
development environments (which should not have secure credentials for anything) but you <strong>MUST</strong> ensure you define
secure passwords for a any production server. Generally available QA and similar hosts that could be compromised
should also have secure passwords, different to the ones used in production.
The recipes will emit a warning log if you deploy outside Vagrant with an insecure password.</p>
</blockquote>

<h2>Recipes</h2>

<h3>No default recipe</h3>

<p>As this cookbook provides both server and client related mysql things, there is no default recipe.</p>

<h3><code>ingenerator-mysql::server</code></h3>

<p>This recipe will:</p>

<ul>
<li>install a mysql server</li>
<li>manage the mysql root password</li>
<li>install the mysql client, ruby mysql gem and database bindings for use in chef</li>
<li>create a schema for the application</li>
<li>create a non-root user account for the application - by default only with permissions on the app schema</li>
<li>if running on vagrant, bind mysql to any interface and allow remote root access so workbench etc work from the host</li>
</ul>

<h3><code>ingenerator-mysql::app_db_server</code></h3>

<p>This is intended to be run on the database server instance for an application (and is included with
the standard <code>ingenerator-mysql::server</code> recipe above). It handles two main tasks:</p>

<ul>
<li>create a schema for the application - named with the project name by default</li>
<li>create a restricted-privilege database user for use by general application code - again with the project name by default</li>
</ul>

<p>The application database user, by default, can only connect from localhost but you can configure this by setting the
<code>node[&#39;project&#39;][&#39;services&#39;][&#39;db&#39;][&#39;connect_anywhere&#39;]</code> attribute to true. It has limited permissions which can be
customised by setting the appropriate key in <code>node[&#39;project&#39;][&#39;services&#39;][&#39;db&#39;][&#39;privileges&#39;][{mysql permission name}]</code>
to true.</p>

<blockquote>
<p><strong>Security Considerations!</strong>
Granting granting elevated privileges to a user that runs in the context of a web application is a likely security
hole. Before activating additional privileges for the application user you should consider whether you can either
use a separate database user (for example, for command line admin tasks that run outside the web context) or implement
a message queue or similar so that the web process can only trigger a set of whitelisted application use cases which
executed by a privileged user in a separate process.</p>
</blockquote>

<h3><code>ingenerator-mysql::dev-db</code></h3>

<p>This recipe will:</p>

<ul>
<li>provision a standard basic development database if missing</li>
<li>run SQL files against the development database if configured or if the dump files have changed</li>
</ul>

<p>To use it, add SQL files that take the desired action - generally, drop an entire table and recreate it - as
cookbook files in your project.</p>

<pre><code class="sql">/* application-cookbook/files/default/dev_db/users.sql */
CREATE SCHEMA myapplication IF NOT EXIST;
DROP TABLE IF EXISTS users;
CREATE TABLE users /*....
</code></pre>

<p>Add each file to the <code>node[&#39;mysql&#39;][&#39;dev_db&#39;][&#39;sql_files&#39;]</code> hash - for example:</p>

<pre><code class="ruby">node.default[&#39;mysql&#39;][&#39;dev_db&#39;][&#39;sql_files&#39;][&#39;application-coobook::dev_db/users.sql&#39;] = true
</code></pre>

<p>By default, the files will be copied to a local path on your machine in order to detect if they
have changed since the last deploy. Any changed files will be passed to mysql as root during
deployment.</p>

<p>You can force a reprovision by setting <code>node[&#39;mysql&#39;][&#39;dev_db&#39;][&#39;recreate_always&#39;]</code> to true -
for example, you&#39;d probably do so in a build slave role to ensure the test db was always clean.</p>

<p>Alternatively you can force a one-off reprovision with an environment variable - eg
<code>$ RECREATE_DEV_DB=1 architecture/provision dev-server</code>.</p>

<p>You should consider setting the attribute from an environment variable in your Vagrantfile to
allow the same workflow on your host machine.</p>

<blockquote>
<p><strong>DANGER!</strong>
If included, this recipe will without warning run your SQL scripts, probably wiping your entire
database. To reduce the risk you accidentally run it on a production box, it will fail if the
root password is anything other than &quot;mysql&quot;. It should be obvious that inclusion of this recipe
should be treated with care.</p>
</blockquote>

<h2>Attributes</h2>

<p>The cookbook provides and is controlled by a number of default attributes:</p>

<ul>
<li><a href="attributes/default.rb">default</a> - customisation of mysql config and generic mysql attributes</li>
<li><a href="attributes/app_db.rb">app_db</a> - attributes related to the application database, including tweaks to related cookbooks</li>
</ul>

<h3>Testing</h3>

<p>See the <a href=".travis.yml">.travis.yml</a> file for the current test scripts.</p>

<h2>Contributing</h2>

<ol>
<li>Fork the project</li>
<li>Create a feature branch corresponding to your change</li>
<li>Create specs for your change</li>
<li>Create your changes</li>
<li>Create a Pull Request on github</li>
</ol>

<h2>License &amp; Authors</h2>

<ul>
<li>Author:: Andrew Coulton (<a href="mailto:andrew@ingenerator.com">andrew@ingenerator.com</a>)</li>
</ul>

<pre><code class="text">Copyright 2012-2013, inGenerator Ltd

Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre>

    </div>

    <div id="dependencies-tab">
      
        <ul class="dependency-list">
          
            
            
              <li>apt ~> 2.4</li>
            
          
            
            
              <li>database ~> 2.3.1</li>
            
          
            
            
              <li>mysql ~> 5.3</li>
            
          
        </ul>
      
    </div>

    <div id="changelog-tab" class="markdown">
      <h1>Change Log</h1>

<p>All notable changes to this project will be documented in this file.
This project adheres to <a href="http://semver.org/">Semantic Versioning</a>. Note that
0.x versions may be breaking, per the semver standard.</p>

<h2>Unreleased</h2>

<h2>0.1.0 (2016-09-06)</h2>

<ul>
<li>First tagged release</li>
</ul>

    </div>
  </div>
</main>


<div class="detail-sidebar">
  <h4>Added to MiniMart</h4>
  <p>November 17, 2020</p>
  <h4>Maintainer</h4>
  <p>Andrew Coulton</p>
  <dl class="platform-list">
    <dt>Supported Platforms</dt>
    
      <dd><i class="icon-ubuntu" title="Ubuntu"></i></dd>
    
  </dl>
  
  <a href="https://github.com/ingenerator/chef-ingenerator-mysql" class="button detail-sidebar__halfbutton">Source</a>
  
  
  <a href="https://github.com/ingenerator/chef-ingenerator-mysql/issues" class="button detail-sidebar__halfbutton">Issues</a>
  
  <a href="../../cookbook_files/ingenerator-mysql/0_1_0/ingenerator-mysql-0.1.0.tar.gz" class="button detail-sidebar__button">Download</a>
</div>

<script>
$(function () {
  $('.tab-container').tabslet();
  $('.cookbook-version-selector').change(function () {
    document.location.href = encodeURI($(this).val());
  });
  $('#cookbook-search-form').submit(function (ev) {
    ev.preventDefault();
    var searchValue, searchPath;
    searchValue = $(this).find('input[name="query"]').val();
    searchPath  = $(this).attr('action');
    document.location.href = encodeURI(searchPath + searchValue);
  });
});
</script>

  </div>

  <footer class="footer">
    <a href="http://www.madglory.com" target="_blank">
      Powered by
      <span class="footer__logo">
        <img src="../../assets/images/mad-glory-logo.png" alt="Mad Glory" />
      </span>
    </a>
  </footer>
</body>
</html>
